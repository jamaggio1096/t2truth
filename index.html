import React, { useState } from 'react';
import { getAuth, GoogleAuthProvider, signInWithPopup, signInWithEmailAndPassword, createUserWithEmailAndPassword, sendEmailVerification } from 'firebase/auth';
import { initializeApp } from 'firebase/app';
import './Auth.css'; // style this to match your uploaded design

const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_BUCKET.appspot.com",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

export default function LoginRegister() {
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [mode, setMode] = useState('login'); // or 'register'

  const handleGoogleLogin = async () => {
    const provider = new GoogleAuthProvider();
    try {
      await signInWithPopup(auth, provider);
      alert("Logged in with Google");
    } catch (err) {
      alert(err.message);
    }
  };

  const handleEmailAuth = async () => {
    try {
      if (mode === 'login') {
        await signInWithEmailAndPassword(auth, email, password);
        alert("Logged in with Email");
      } else {
        const userCredential = await createUserWithEmailAndPassword(auth, email, password);
        await sendEmailVerification(userCredential.user);
        alert("Registration successful. Please verify your email.");
      }
    } catch (err) {
      alert(err.message);
    }
  };

  return (
    <div className="auth-container">
      <div className="auth-modal">
        <h2>Sign-in</h2>
        <button onClick={handleGoogleLogin} className="oauth google">Continue with Google</button>
        <button className="oauth facebook">Continue with Facebook</button>
        <button className="oauth apple">Continue with Apple</button>
        <div className="divider">or</div>
        <input type="email" placeholder="Your email" onChange={e => setEmail(e.target.value)} />
        <input type="password" placeholder="Your password" onChange={e => setPassword(e.target.value)} />
        <button onClick={handleEmailAuth} className="login">{mode === 'login' ? "Login" : "Register"}</button>
        <p>
          {mode === 'login' ? "Don't have an account?" : "Already have an account?"}
          <span onClick={() => setMode(mode === 'login' ? 'register' : 'login')}>
            {mode === 'login' ? " Register" : " Login"}
          </span>
        </p>
      </div>
    </div>
  );
}